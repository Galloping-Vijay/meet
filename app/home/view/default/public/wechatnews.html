<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script type="text/javascript" charset="utf-8">
    wx.config({$wxconfig});
</script>
<script>
    wx.ready(function () {

        //获取“分享到朋友圈”按钮点击状态及自定义分享内容接口
        wx.onMenuShareTimeline({
            title: "<?php echo $news_title;?>",
            link: "<?php echo request()->url(true);?>",
            imgUrl: "<?php echo request()->domain().get_imgurl($news_img);?>",
            success: function () {
                $.ajax({
                    url: "<?php echo request()->url(true);?>",
                    success: function () {
                        alert('分享成功');
                    },
                    error: function () {
                        console.log('失败');
                    }
                });
            },
            cancel: function (res) {
                // alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
        // 获取“分享给朋友”按钮点击状态及自定义分享内容接口
        wx.onMenuShareAppMessage({
            title: "<?php echo $news_title;?>",
            desc: "<?php echo $news_scontent;?>",
            link: "<?php echo request()->url(true);?>",
            imgUrl: "<?php echo request()->domain().get_imgurl($news_img);?>",
            success: function (res) {
                alert('分享成功');
            },
            cancel: function (res) {
                // alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });


        //获取“分享到QQ”按钮点击状态及自定义分享内容接口
        wx.onMenuShareQQ({
            title: "<?php echo $news_title;?>",
            desc: "<?php echo $news_scontent;?>",
            link: "<?php echo request()->url(true);?>",
            imgUrl: "<?php echo request()->domain().get_imgurl($news_img);?>",
            success: function () {
                // 用户确认分享后执行的回调函数
                $.ajax({
                    url: "<?php echo request()->url(true);?>",
                    success: function () {
                        alert('分享成功');
                    },
                    error: function () {
                        console.log('失败');
                    }
                });
            },
            cancel: function (res) {
                // alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
        //获取“分享到QQ空间”按钮点击状态及自定义分享内容接口
        wx.onMenuShareQZone({
            title: "<?php echo $news_title;?>",
            desc: "<?php echo $news_scontent;?>",
            link: "<?php echo request()->url(true);?>",
            imgUrl: "<?php echo request()->domain().get_imgurl($news_img);?>",
            success: function () {
                // 用户确认分享后执行的回调函数
                // 用户确认分享后执行的回调函数
                $.ajax({
                    url: "<?php echo request()->url(true);?>",
                    success: function () {
                        alert('分享成功');
                    },
                    error: function () {
                        console.log('失败');
                    }
                });
            },
            cancel: function (res) {
                // alert('已取消');
            },
            fail: function (res) {
                alert(JSON.stringify(res));
            }
        });
    });
    wx.error(function (res) {
        // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
        alert(JSON.stringify(res));
    });

</script>